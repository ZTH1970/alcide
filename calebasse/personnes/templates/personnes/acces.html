{% extends "personnes/base.html" %}

{% block extrascripts %}
<script src="{{ STATIC_URL }}js/calebasse.reset-button.js"></script>
{% endblock %}

{% block appbar %}
<h2>Gestion des personnes — Accès</h2>
<a href="../">Retourner à la gestion des personnes</a>

<button class="dialog-button" data-url="new/ #form-content" data-default-button="Créer">Nouvel accès</button>
{% endblock %}

{% block beforecontent %}
<div id="sidebar">
  <div>
    <h3>Rechercher dans les comptes</h3>
    <form>
      <label>Identifiant :
        <input type="text"/ name='identifier' value="{{ request.GET.identifier }}">
      </label>
      {% if request.GET %}
      <div class="search-reset">
        <button id="search">Rechercher</button>
        <button id="reset" class="icon-remove-sign" title="Réinitialiser"></button>
      </div>
      {% else %}
        <button id="search">Rechercher</button>
      {% endif %}
    </form>
  </div>
</div>
{% endblock %}

{% block content %}
<div class="content">
  {% if active_list %}
  <table class="main" id="timetable-table">
    <thead>
    <tr>
      <th>Identifiant</th>
      <th>Courriel</th>
      <th>Fiche Personnel</th>
      <th>Roles</th>
      <th>Supprimer</th>
    </tr>
    </thead>
    <tbody>
   {% for object in active_list %}
     <tr data-pk="{{object.pk}}" id="object-{{ object.pk}}">
      <td>{{object.username}}</td>
      <td>{{object.email}}</td>
      {% with worker=object.userworker.worker %}
      <td>{% if worker %}<a href="{{ worker.get_absolute_url }}">{{ worker }}</a>{% else %}-{% endif %}</td>
      {% endwith %}
      <td>{% for role in object.groups.all %}{{ role.name }} {% endfor %}</td>
      <td><button class="icon-minus"/></td>
    </tr>
   {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p>Il n'y a aucun compte actif</p>
  {% endif %}

  {% if inactive_list %}
  <h4>Comptes désactivés</h4>

  <table class="main">
    <thead>
    <tr>
      <th>Identifiant</th>
      <th>Courriel</th>
      <th>Fiche Personnel</th>
    </tr>
    </thead>
    <tbody>
   {% for object in object_list %}
    {% if not object.is_active %}
    <tr data-pk="{{object.pk}}">
      <td>{{object.username}}</td>
      <td>{{object.email}}</td>
      <td>{% firstof object.userworker.worker "-" %}</td>
      <td><button class="icon-edit"></button> <button class="icon-minus"></button> <button>Histo</button></td>
    </tr>
    {% endif %}
   {% endfor %}
    </tbody>
  </table>
  {% endif %}
</div>
{% endblock %}
